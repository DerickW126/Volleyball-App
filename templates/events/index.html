<!-- templates/events/index.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Volleyball Events</title>
</head>
<body>
    <h1>Volleyball Events</h1>
    <ul>
        {% for event in events %}
        <li>
            <strong>{{ event.name }}</strong> - {{ event.location }} - {{ event.date }} - {{ event.start_time }} to {{ event.end_time }} - Spots left: {{ event.spots_left }} - Created by: {{ event.created_by.username }}
            {% if user.is_authenticated %}
                {% if event.created_by == user %}
                    <p><strong>Registered Users:</strong></p>
                    <ul>
                        {% for registration in event.registration_set.all %}
                            <li>{{ registration.user.username }} - {{ registration.number_of_people }} people</li>
                        {% empty %}
                            <li>No one has registered yet.</li>
                        {% endfor %}
                    </ul>
                {% endif %}
                {% if event.spots_left > 0 %}
                    <form method="post" action="{% url 'register_event' event.id %}">
                        {% csrf_token %}
                        <button type="submit">Register</button>
                    </form>
                {% else %}
                    <p>No spots left</p>
                {% endif %}
                <form method="post" action="{% url 'unregister_event' event.id %}">
                    {% csrf_token %}
                    <button type="submit">Unregister</button>
                </form>
            {% endif %}
        </li>
        {% endfor %}
    </ul>
    {% if user.is_authenticated %}
        <a href="{% url 'add_event' %}">Add Event</a>
    {% else %}
        <p><a href="{% url 'account_login' %}">Log in</a> to add or register for events.</p>
    {% endif %}
</body>
</html>
